<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <!--[if mso]>
      <xml>
        <o:OfficeDocumentSettings>
          <o:AllowPNG/>
          <o:PixelsPerInch>96</o:PixelsPerInch>
        </o:OfficeDocumentSettings>
      </xml>
    <![endif]-->
    <meta name="x-apple-disable-message-reformatting">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
  </head>
  <body style="margin:0; padding:0; background:#f6f7fb;">
    <!-- Header -->
    <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="background:#003366; color:#ffffff; mso-table-lspace:0pt; mso-table-rspace:0pt;">
      <tr>
        <td align="center" style="padding:12px 16px; font-family:Arial, Helvetica, sans-serif; font-size:20px; font-weight:bold;">
          <img src="{{LogoUrl}}" alt="{{CompanyName}} Logo" width="120" height="40" style="display:block; margin:0 auto 6px auto;">
          {{CompanyName}}
        </td>
      </tr>
    </table>

    <!-- Card -->
    <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="background:#f6f7fb; mso-table-lspace:0pt; mso-table-rspace:0pt;">
      <tr>
        <td align="center" style="padding:20px 12px;">
          <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="max-width:600px; background:#ffffff; border:1px solid #e4e6ef; border-radius:6px;">
            <!-- Intro -->
            <tr>
              <td style="font-family: Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; color:#333; padding:16px; mso-padding-alt:16px;">
                Hello {{RecipientName}},<br><br>
                {{IntroText}}
              </td>
            </tr>

            <!-- Key/Value Table -->
            <tr>
              <td style="padding:0 16px 16px 16px; mso-padding-alt:0 16px 16px 16px;">
                <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;">
                  {{Rows}}
                </table>
              </td>
            </tr>

            <!-- Closing -->
            <tr>
              <td style="font-family: Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; color:#333; padding:16px; mso-padding-alt:16px;">
                Thank you,<br>
                <strong>{{CompanyName}}</strong>
              </td>
            </tr>
          </table>

          <!-- Footer / Disclaimer -->
          <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="background:#f0f0f0; margin-top:20px;">
            <tr>
              <td style="font-family: Arial, Helvetica, sans-serif; font-size:11px; line-height:16px; color:#666; padding:12px 16px; mso-padding-alt:12px 16px; text-align:center;">
                Â© {{Year}} {{CompanyName}}. All rights reserved.<br>
                This message (including any attachments) is confidential and may be privileged. If you are not the intended recipient, please delete it and notify the sender. Any unauthorized use or disclosure is prohibited.
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
</html>
<tr>
  <td width="40%" style="font-family:Arial, Helvetica, sans-serif; font-size:13px; line-height:18px; color:#4a4a4a; background:#f8f9fc; padding:4px 8px; mso-padding-alt:4px 8px 4px 8px; border:1px solid #e9ecf3; border-right:none;">
    {{Key}}
  </td>
  <td style="font-family:Arial, Helvetica, sans-serif; font-size:13px; line-height:18px; color:#111; padding:4px 8px; mso-padding-alt:4px 8px 4px 8px; border:1px solid #e9ecf3; border-left:none;">
    {{Value}}
  </td>
</tr>
using System.Net;
using System.Text;
using System.Collections.Generic;

static string BuildRows(Dictionary<string, string> keyValues)
{
    var sb = new StringBuilder();
    foreach (var kv in keyValues)
    {
        // HTML-encode values for safety
        string key = WebUtility.HtmlEncode(kv.Key);
        string val = WebUtility.HtmlEncode(kv.Value ?? string.Empty);

        sb.Append($@"
<tr>
  <td width=""40%"" style=""font-family:Arial, Helvetica, sans-serif; font-size:13px; line-height:18px; color:#4a4a4a; background:#f8f9fc; padding:4px 8px; mso-padding-alt:4px 8px 4px 8px; border:1px solid #e9ecf3; border-right:none;"">{key}</td>
  <td style=""font-family:Arial, Helvetica, sans-serif; font-size:13px; line-height:18px; color:#111; padding:4px 8px; mso-padding-alt:4px 8px 4px 8px; border:1px solid #e9ecf3; border-left:none;"">{val}</td>
</tr>");
    }
    return sb.ToString();
}

static string PopulateTemplate(string templateHtml, Dictionary<string, string> tokens)
{
    var html = templateHtml;
    foreach (var kv in tokens)
    {
        html = html.Replace(kv.Key, kv.Value ?? string.Empty);
    }
    return html;
}

// Usage:
var template = System.IO.File.ReadAllText("EmailTemplate.html");

var data = new Dictionary<string, string>
{
    { "Request ID", "MIM_001" },
    { "Customer", "Acme Corp" },
    { "Submitted On", DateTime.UtcNow.ToString("MMM d, yyyy") },
    { "Status", "Approved" }
};

var rowsHtml = BuildRows(data);

var tokens = new Dictionary<string, string>
{
    { "{{CompanyName}}", "Your Company Name" },
    { "{{LogoUrl}}", "https://via.placeholder.com/120x40?text=Logo" },
    { "{{RecipientName}}", "John" },
    { "{{IntroText}}", "Below is the summary of your recent request submitted through our system:" },
    { "{{Rows}}", rowsHtml },
    { "{{Year}}", DateTime.UtcNow.Year.ToString() }
};

var finalHtml = PopulateTemplate(template, tokens);

// send finalHtml with your mailer (SmtpClient, SendGrid, etc.)
